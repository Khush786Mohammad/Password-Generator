<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="style.css">
        <link rel="shortcut icon" href="./images/favicon.png" type="image/x-icon">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"/>
        <title>Password Generator</title>
    </head>
<body class="m-0 p-0 box-border overflow-hidden">
    <div class="wrapper w-[100vw] h-[100vh] flex flex-wrap justify-center items-center bg-purple-700">
        <div class="container w-[28rem] flex flex-col gap-6">
            <h1 class="text-center xs:text-[2rem] text-[1.5rem] text-gray-100 font-semibold uppercase
             opacity-90 leading-[1.2] mx-5">Password Generator</h1>
            <!-- Password block -->
            <div class="display-container bg-[#1c0d2c] flex justify-between py-1 rounded-[1rem] mx-7
             transition-all ease-in duration-200 hover:scale-105">
                <input readonly id="password" name="password" placeholder="PASSWORD" data-passwordDisplay 
                class="w-[90%] text-xl font-bold outline-none pl-5 bg-[#1c0d2c] rounded-[1rem]
                text-yellow-400 placeholder-yellow-400 placeholder-opacity-80"> <!--data-passwordDisplay is a custom attribute-->
                <button data-copy class="flex flex-col relative pr-1">
                    <span data-copyMsg class="text-yellow-300 bg-[#30278e] text-[1rem]
                    font-semibold absolute bottom-[80%]"></span>
                    <i class="fa-solid fa-copy p-4 text-[#00ffcc] text-xl"></i>
                </button>
            </div>

            <!-- input container -->
            <div class="password-queries-section flex flex-col px-7 rounded-[1rem] py-6 bg-[#1c0d2c] gap-6 mx-7">
                <div class="length-container flex flex-row justify-between">
                    <p class="pass-text text-white font-semibold text-[1.2rem]">Password Length</p>
                    <p id="lengthNumber" class="text-[1.2rem] text-yellow-300 font-bold">0</p>
                </div>
                <!-- slider #483063-->
                <input type="range" min="1" max="20"  step="1" data-lengthSlider class="slider appearance-none cursor-pointer rounded-[1rem] h-[0.8rem] w-[100%]
                focus:outline focus:outline-3 focus:outline-yellow-300 bg-gradient-to-r from-[#c338ff] to-[#c338ff] bg-no-repeat border-none bg-[#483063]">
                <div class="checkboxes flex flex-col gap-2">
                    <div class="check flex items-center">
                        <input type="checkbox" id="uppercase" name="check" checked class="appearance-none relative hover:cursor-pointer w-4 h-4
                        border-[1px] border-[#00ffcc] rounded checked:bg-[#00ffcc]">
                        <label for="uppercase" class="text-white font-medium pl-3 text-[1.1rem]">Include Uppercase Letters</label>
                    </div>
                    <div class="check flex items-center">
                        <input type="checkbox" id="lowercase" name="check" class="appearance-none relative hover:cursor-pointer w-4 h-4 border-[1px] border-[#00ffcc] rounded checked:bg-[#00ffcc]">
                        <label for="lowercase" class="text-white font-medium pl-3 text-[1.1rem]">Include Lowercase Letters</label>
                    </div>
                    
                    <div class="check flex items-center">
                        <input type="checkbox" id="numbers" name="check" class="appearance-none relative hover:cursor-pointer w-4 h-4 border-[1px] border-[#00ffcc] rounded checked:bg-[#00ffcc]">
                        <label for="numbers" class="text-white font-medium pl-3 text-[1.1rem]">Include Numbers</label>
                    </div>
                    <div class="check flex items-center">
                        <input type="checkbox" id="symbols" name="check" class="appearance-none relative hover:cursor-pointer w-4 h-4 border-[1px] border-[#00ffcc] rounded checked:bg-[#00ffcc]">
                        <label for="symbols" class="text-white font-medium pl-3 text-[1.1rem]">Include Symbols</label>
                    </div>
                </div>

                <!-- Strength Container -->
                <div class="flex justify-between">
                    <h2 class="text-white font-semibold text-[1.3rem]">Strength</h2>
                    <div class="strength-Indicator w-[1.6rem] h-[1.6rem] rounded-full bg-[gray] shadow-[0px_0px_10px_rgba(128,128,128,1)]"></div>
                </div>
                <!-- Generate Password -->
                <div class="generatePassword cursor-pointer border-[#1c0d2c] text-center py-3 text-yellow-200 uppercase font-bold rounded-[1rem] 
                tracking-[1px] bg-[#c338ff] hover:scale-105 transition-all ease-in duration-200">Generate Password</div>
            </div>
        </div>
    </div>
    <script>
        const passwordDisplay = document.querySelector('[data-passwordDisplay]');
const copyMessage = document.querySelector('[data-copyMsg]');
const dataCopy = document.querySelector('[data-copy]');
let passwordLength = document.querySelector('#lengthNumber');
const slider = document.querySelector('[data-lengthSlider]');
const uppercase = document.querySelector("#uppercase");
const lowercase = document.querySelector('#lowercase');
const numbers = document.querySelector('#numbers');
const specialSymbols = document.querySelector("#symbols");
const allCheck = document.querySelectorAll("input[type=checkbox]");
const strengthIndicator = document.querySelector('.strength-Indicator');
const generate = document.querySelector('.generatePassword');

let password = "";
let len = 10;
let checkCount = 1;

handleSlider(20); 
// slider function
function handleSlider(){
    slider.value=len;
    passwordLength.innerText = len;

    let mini = slider.min;
    let maxi = slider.max;

    slider.style.backgroundSize = ((len-mini)*100/(maxi-mini)) + "% 100%";
}

// setting the strength indicator
function setIndicator(color,shadow){
    strengthIndicator.style.backgroundColor = color;
    strengthIndicator.style.boxShadow = shadow;
}
// Generate a random value of integer, character, special symbols
function generateRandom(max,min){
    return Math.floor(Math.random()*(max-min) + min);
}

function generateRandomNumber(){
    return generateRandom(0,9);
}

function generateRandLowerCase(){
    return String.fromCharCode(generateRandom(97,123));
}

function generateRandUpperCase(){
    return String.fromCharCode(generateRandom(65,91));
}

const symbolArray = ["!","@","#","$","%","^","&","*","(",")","_","+","{","}","[","]",";",":","'","?","/","~"];
const symbolArrayLength = symbolArray.length;

function generateRandSymbol(){
    const randIdx = parseInt(generateRandom(0,symbolArrayLength));
    return symbolArray[randIdx];
}

function calStrength(){
    let hasUpper = false;
    let hasLower = false;
    let hasSymbol = false;
    let hasNumbers = false;
    
    if(uppercase.checked) hasUpper = true;
    if(lowercase.checked) hasLower = true;
    if(numbers.checked) hasNumbers = true;
    if(specialSymbols.checked) hasSymbol = true;

    if(hasUpper && hasLower && (hasSymbol || hasNumbers) && len >= 8){
        setIndicator('#0f0','0px 0px 20px rgba(0, 255, 0, 1)');
    }
    else if((hasUpper || hasLower) && hasNumbers && hasSymbol && len >= 8){
        setIndicator('#0f0','0px 0px 20px rgba(0, 255, 0, 1)');
    }
    else if(hasUpper && hasLower && (hasSymbol || hasNumbers) && len <= 8 && len >=6){
        setIndicator('#ff0','0 0 10px rgba(255, 255, 0, 1)');
    }
    else if(hasUpper && hasLower && len >= 12){
        setIndicator('#0f0','0px 0px 20px rgba(0, 255, 0, 1)');
    }
    else if(hasUpper && hasLower && len >=7 && len <=11){
        setIndicator('#ff0','0 0 10px rgba(255, 255, 0, 1)');
    }
    else if((hasSymbol && hasLower && len >= 8 && len<=10) || (len >=15 && len <= 20)){
        setIndicator('#ff0','0 0 10px rgba(255, 255, 0, 1)')
    }
    else{
        setIndicator('#f00','0 0 10px rgba(255, 0, 0, 1)');
    }
}

// Copy the password function

async function copyFunction(){
    let content = passwordDisplay.value;
    try{
        await navigator.clipboard.writeText(content);
        copyMessage.textContent = "Copied";
    }
    catch(e){
        window.alert("Failed to Copy the password",e);
        copyMessage.textContent = "Failed";
    }

    copyMessage.classList.add('copyButton');

    setTimeout(()=>{
        copyMessage.textContent = "";
        copyMessage.classList.remove('copyButton');
    },2000);
    
}

dataCopy.addEventListener('click', () => {
    if(passwordDisplay.value){
        copyFunction();
    }
});



slider.addEventListener('input' , (e) => {
    len = e.target.value;
    handleSlider();
})

// Main Logic

// Update Check Count

// event listener on uppercase

allCheck.forEach((element) => {
    element.addEventListener('change',(e) => {
        if(e.target.checked){
            checkCount++;
        }
        else{
            checkCount--;
        }
    });
});

generate.addEventListener('click',() => {
    if(checkCount == 0){
        window.alert('Please Check atleast One Option');
        return;
    }

    if(checkCount > len){
        len = checkCount;
        handleSlider();
    }

    password = "";

    const funcArray = [];
    if(uppercase.checked){
        funcArray.push(generateRandUpperCase);
    }

    if(lowercase.checked){
        funcArray.push(generateRandLowerCase);
    }

    
    if(numbers.checked){
        funcArray.push(generateRandomNumber);
    }

    
    if(specialSymbols.checked){
        funcArray.push(generateRandSymbol);
    }

    for(let i = 1 ; i<=len ; i++){
        let randIdx = generateRandom(0,funcArray.length);
        
        password += funcArray[randIdx]();
    }

    // Now Calculate the strength of the password

    passwordDisplay.value = password;
    calStrength();
});

    </script>
</body>
</html> 